<!DOCTYPE html>
<html>
<head>
  <title>Vice Tactics - Phase 2 MVP</title>
  <style>
    body { font-family: monospace; background: #0f0f0f; color: #eee; margin: 0; padding: 0; }
    .board { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 20px; }
    .zone, .hero { background: #1e1e1e; border: 2px solid #333; padding: 10px; min-height: 150px; text-align: center; border-radius: 8px; }
    .card { background: #292929; padding: 10px; border: 1px solid #555; margin: 5px; border-radius: 6px; animation: playCard 0.5s ease-out; }
    @keyframes playCard {
      from { transform: scale(1.2); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
  </style>
</head>
<body>
  <h1 style="padding: 10px;">Vice Tactics â€“ Swashbuckler vs Psy-Ops AI</h1>
  <div style="padding: 0 20px;">Player HP: <span id="playerHP">25</span> | Opponent HP: <span id="opponentHP">25</span> | Vice: <span id="viceStatus">1/1</span></div>
  <div class="board">
    <div class="zone" id="opponentZone">Opponent Cards</div>
    <div class="hero" id="opponentHero">Psy-Ops Soldier</div>
    <div class="zone" id="opponentTech">Opponent Tech</div>

    <div class="zone" id="playerCombat">Combat Cards</div>
    <div class="hero" id="playerHero">Swashbuckler</div>
    <div class="zone" id="playerTech">Tech/Spells</div>
  </div>

  <div style="padding: 20px;">
    <button onclick="endTurn()">End Turn</button>
    <div><strong>Hand:</strong> <div id="hand" style="display: flex; flex-wrap: wrap;"></div></div>
    <div><strong>Turn Log:</strong> <div id="log" style="max-height: 200px; overflow-y: auto; background: #111; border: 1px solid #444; padding: 10px;"></div></div>
  </div>

<script>
let playerHP = 25, opponentHP = 25, turn = 1, maxVice = 1, currentVice = 1;
let hand = [], deck = [], aiDeck = [], log = [];

const heroModifiers = {
  "Swashbuckler": { spell: 0, combat: -2, tech: 0 },
  "Psy-Ops Soldier": { spell: -1, combat: -2, tech: -1 }
};

const swashbucklerDeck = [
  "Headbutt", "Adrenal Surge", "Combat Strategist", "Shield Block", "Blade Flurry",
  "Backstab", "Chain Lightning", "Magic Missile", "Arcane Echo", "Overclock"
];

const psyOpsDeck = [
  "Spellfire", "Curse of Vice", "Mana Burn", "Arcane Echo", "Combat Strategist",
  "Backstab", "Blade Flurry", "Magic Missile", "Battle Meditation", "Chain Lightning"
];

const cardEffects = {
  "Headbutt": { type: "combat", cost: 4, damage: 4, selfDamage: 1 },
  "Adrenal Surge": { type: "combat", cost: 1, damage: 1, heal: 1 },
  "Combat Strategist": { type: "combat", cost: 5, damage: 3 },
  "Shield Block": { type: "combat", cost: 2, block: 3 },
  "Blade Flurry": { type: "combat", cost: 4, damage: 4 },
  "Backstab": { type: "combat", cost: 3, damage: 2 },
  "Chain Lightning": { type: "spell", cost: 5, damage: 5 },
  "Magic Missile": { type: "spell", cost: 2, damage: 2 },
  "Arcane Echo": { type: "spell", cost: 1, draw: 1 },
  "Overclock": { type: "tech", cost: 2, draw: 2 },
  "Spellfire": { type: "spell", cost: 2, damage: 3 },
  "Curse of Vice": { type: "spell", cost: 4, damage: 2 },
  "Mana Burn": { type: "spell", cost: 3, damage: 2, selfDamage: 1 },
  "Battle Meditation": { type: "spell", cost: 3, heal: 3 }
};

function drawCard(deckList) {
  if (deckList.length) return deckList.pop();
  return null;
}

function applyEffects(cardName, isPlayer = true) {
  const effect = cardEffects[cardName];
  const mod = heroModifiers[isPlayer ? "Swashbuckler" : "Psy-Ops Soldier"][effect.type] || 0;
  const actualCost = Math.max(0, effect.cost + mod);

  if (actualCost > currentVice) return false;

  currentVice -= actualCost;
  if (effect.damage) (isPlayer ? opponentHP : playerHP) -= effect.damage;
  if (effect.heal) (isPlayer ? playerHP : opponentHP) += effect.heal;
  if (effect.selfDamage) (isPlayer ? playerHP : opponentHP) -= effect.selfDamage;
  if (effect.draw) {
    for (let i = 0; i < effect.draw; i++) {
      const newCard = drawCard(isPlayer ? deck : aiDeck);
      if (newCard) hand.push(newCard);
    }
  }

  log.push((isPlayer ? "Player" : "AI") + " played " + cardName + " for " + actualCost + " Vice.");
  return true;
}

function render() {
  document.getElementById("playerHP").textContent = playerHP;
  document.getElementById("opponentHP").textContent = opponentHP;
  document.getElementById("viceStatus").textContent = `${currentVice}/${maxVice}`;
  document.getElementById("log").innerHTML = log.slice(-20).join("<br>");

  const handDiv = document.getElementById("hand");
  handDiv.innerHTML = "";
  hand.forEach((card, i) => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `<strong>${card}</strong><br><button onclick="playCard(${i})">Play</button>`;
    handDiv.appendChild(div);
  });
}

function playCard(index) {
  const name = hand[index];
  const success = applyEffects(name);
  if (success) hand.splice(index, 1);
  render();
}

function endTurn() {
  // AI turn
  let aiVice = Math.min(turn + 1, 10);
  for (let i = 0; i < 3; i++) {
    const card = drawCard(aiDeck);
    if (card) {
      const effect = cardEffects[card];
      const mod = heroModifiers["Psy-Ops Soldier"][effect.type] || 0;
      const cost = Math.max(0, effect.cost + mod);
      if (cost <= aiVice) {
        aiVice -= cost;
        applyEffects(card, false);
      }
    }
  }

  turn++;
  maxVice = Math.min(10, turn);
  currentVice = maxVice;
  const newCard = drawCard(deck);
  if (newCard) hand.push(newCard);
  render();
}

// Game start
deck = [...swashbucklerDeck, ...swashbucklerDeck].sort(() => Math.random() - 0.5);
aiDeck = [...psyOpsDeck, ...psyOpsDeck].sort(() => Math.random() - 0.5);
for (let i = 0; i < 5; i++) hand.push(drawCard(deck));
render();
</script>
</body>
</html>
